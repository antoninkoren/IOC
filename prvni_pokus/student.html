<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Žák</title>
</head>
<body>
  <h2 id="name"></h2>
  <p>Čas: <span id="time">0</span> s</p>

  <script>
    if (localStorage.getItem("role") !== "student") {
      location.href = "index.html";
    }

    const studentName = localStorage.getItem("name");
    document.getElementById("name").innerText = studentName;

    let time = 0;
    let qrLeft = 10;

    setInterval(() => {
      time++;
      document.getElementById("time").innerText = time;

      navigator.geolocation.getCurrentPosition(pos => {
        let students = JSON.parse(localStorage.getItem("students") || "{}");

        students[studentName] = {
          time,
          qrLeft,
          lat: pos.coords.latitude,
          lon: pos.coords.longitude,
          updated: Date.now()
        };

        localStorage.setItem("students", JSON.stringify(students));
      });
    }, 3000);
  </script>
</body>
</html>
